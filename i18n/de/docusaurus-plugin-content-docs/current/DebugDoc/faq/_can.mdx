import ImageView from '@site/src/components/ImageView';

----

# Fehlerbehebung basierend auf Fehlermeldungen

    * Hier sind häufige Fehler
        * OSError: [Errno 19] Kein solches Gerät
        * can.CanError: Übertragung fehlgeschlagen: [Errno 100] Netzwerk ist down
        * can.CanError: Übertragung fehlgeschlagen: [Errno 105] Kein Pufferplatz verfügbar
    * Der erste Fehler tritt auf, wenn die Host-Anwendung das Gerät `1d50:606f` nicht finden kann
    * Der zweite Fehler tritt auf, wenn die Host-Anwendung CAN0 nicht konfiguriert hat oder die Konfiguration falsch ist
    * Der dritte Fehler tritt immer auf, wenn die Host-Anwendung nicht genügend Speicher hat oder aufgrund von Systemproblemen der Puffer abstürzt
    * Die zweiten und dritten Punkte können unten durch die Konfiguration von CAN0 überprüft werden
    * Wenn die ID nicht gefunden wird, schauen Sie sich den unteren Abschnitt an

## Prüfen, ob die Host-Anwendung CAN unterstützt

    * Wenn es sich um eine FLY Host-Anwendung handelt, ist dieser Schritt nicht erforderlich
    * Wenn Ihr System `Ubuntu` ist, wird empfohlen, das System zu wechseln, da die CAN-Konfiguration auf diesem System sehr mühsam ist
    * Geben Sie den folgenden Befehl ein, um zu prüfen, ob Ihr System CAN unterstützt

    ```bash
    sudo modprobe can && echo "Ihr Kernel unterstützt CAN" || echo "Ihr Kernel unterstützt CAN nicht"
    ```

    * Nach Eingabe des obigen Befehls wird "Ihr Kernel unterstützt CAN" zurückgegeben, wenn Ihr Kernel CAN unterstützt; andernfalls wird "Ihr Kernel unterstützt CAN nicht" zurückgegeben.

## Konfiguration von CAN0

    * Dieser Befehl überschreibt die ursprüngliche CAN0-Konfiguration des Systems, nach der Ausführung muss das System neu gestartet werden
    
    * Für eine Übertragungsrate von 1M geben Sie den folgenden Befehl ein
----
    ```bash
    sudo /bin/sh -c "cat > /etc/network/interfaces.d/can0" << EOF
        allow-hotplug can0
        iface can0 can static
            bitrate 1000000
            up ifconfig can0 txqueuelen 1024
            pre-up ip link set can0 type can bitrate 1000000
            pre-up ip link set can0 txqueuelen 1024
    EOF
    ```
----
    * Für eine Übertragungsrate von 500K geben Sie den folgenden Befehl ein

    ```bash
    sudo /bin/sh -c "cat > /etc/network/interfaces.d/can0" << EOF
    allow-hotplug can0
    iface can0 can static
        bitrate 500000
        up ifconfig can0 txqueuelen 1024
        pre-up ip link set can0 type can bitrate 500000
        pre-up ip link set can0 txqueuelen 1024
    EOF
    ```

    * Gerät neustarten

    ```bash
    sudo reboot
    ```


## Achten Sie auf folgende Punkte, wenn die ID nicht gefunden wird

    * Wenn Klipper die entsprechende ID konfiguriert hat, muss diese in der Systemkonfiguration zuerst deaktiviert werden, bevor das Gerät heruntergefahren und die Stromversorgung getrennt wird, um es dann wieder einzuschalten oder den Reset-Knopf auf dem Motherboard zu drücken
    * Ob die Übertragungsrate der Host-Anwendung mit der des Motherboards, Werkzeugboards usw. übereinstimmt
    * Mit dem folgenden Code kann die Übertragungsrate der Host-Anwendung bestimmt werden
    * Überprüfen Sie, ob es eine Unterbrechung der Verbindung gibt
    ```bash
    ip -details link show can0
    ```
    * Der unten markierte Bereich zeigt die Übertragungsrate und den Puffer der Host-Anwendung
    * Oben `1024` ist der aktuelle CAN0-Puffer
    * Unten `1000000` ist die aktuelle CAN0-Übertragungsrate

    <ImageView image={require('@site/docs/DebugDoc/faq/img/details.png').default} size="80%" align="center" />

    * Wenn immer noch keine UUID gefunden wird, überprüfen Sie sorgfältig die folgenden Punkte

        * Überprüfen Sie, ob das Motherboard oder das CAN-Werkzeugboard korrekt angeschlossen ist
        * Ob korrekt Strom versorgt wird, es wird empfohlen, bei der Nutzung des Motherboards den VCC-Strom anzuschließen
        * Ob die Host-Anwendung das CAN-Netzwerk unterstützt
        * Ob die Firmware korrekt kompiliert wurde
## ID-Suche

    * Geben Sie den folgenden Befehl ein, um nach der ID zu suchen
    ```bash
    ~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
    ```
    * Wenn eine ID erscheint und `Application:` am Ende Klipper anzeigt, kann diese ID direkt verwendet werden
    * Wenn eine ID erscheint und `Application:` am Ende `CANBOOT` oder `Katapult` anzeigt, muss die Firmware aktualisiert werden, bevor sie verwendet werden kann
    <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.png').default} size="50%" align="left" />


## Methode zur Konfiguration der CAN ID

    * Öffnen Sie die Drucker-Webschnittstelle, finden Sie in der linken Seitenleiste die Konfigurationsoptionen: für fluidd ist es: `{…}` ; für mainsail ist es: `Maschine`, klicken Sie darauf und Sie finden `printer.cfg`

        <ImageView image={require('@site/docs/General/get-id/img/fluidd-cfg.png').default} size="50%" align="left" />

    * Kopieren Sie die gefundene UUID und fügen Sie sie in den `printer.cfg` in den Knoten `[mcu]` unter `canbus_uuid: ` ein. Speichern Sie die Änderungen und starten Sie neu, um die Verbindung zum Motherboard herzustellen. Wenn Klipper darauf hinweist, dass die Firmware aktualisiert werden muss, ADC-Fehler usw., bedeutet dies, dass Klipper bereits eine Verbindung zum Motherboard hergestellt hat

        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.png').default} size="50%" align="left" />

        :::danger

        Hinweis: Alle IDs, die in diesem Dokument erscheinen, sind Beispiele. Die tatsächliche ID jedes Motherboards ist unterschiedlich, bitte ändern Sie und füllen Sie entsprechend der tatsächlich erhaltenen ID.

        :::