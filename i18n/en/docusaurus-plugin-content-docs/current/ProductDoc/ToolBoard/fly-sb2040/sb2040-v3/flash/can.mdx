---
sidebar_position: 3
sidebar_label: CAN Firmware Flashing
---

import CANFLASH from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_host-can-flash.mdx';
import MakeOperate from "/docs/General/klipper-make/_make-operate.mdx";
import CAN from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_firmware/2040/_can1.mdx';
import SSH from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_firmware/_ssh.mdx';


import LS from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_can.mdx';

# CAN Firmware Compilation

## Start Compilation

    <SSH />

    <MakeOperate/>

    <CAN />

    * Choose GPIO pins to set at micro-controller startup, input: !gpio5 Please note that ! is uppercase
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-v3/flash/img/can.webp').default} size="100%" align="center" />
    * Press the `Q` key, when **Save configuration** appears, then press the `Y` key
        <ImageView image={require('@site/docs/General/dfu-flash/img/configuration.webp').default} size="50%" align="center" />
    * The configuration should now be saved and exited to the command line interface
    * Enter `make -j4` to start compilation, it will take some time
        <ImageView image={require('@site/docs/General/dfu-flash/img/make.webp').default} size="50%" align="center" />
    * When the following content is output, the compilation is successful

        ```bash
        Linking out/klipper.elf
        Creating hex file out/klipper.bin
        ```

## Search for Device

    <LS />


## Flash Firmware

    * Before flashing the firmware, use the XT30 data cable to connect the tool board to UTOC or the motherboard that has been flashed with the bridging firmware, the reference wiring diagram is below
    * Please check if the DIP switch is set to the correct position
        <ImageView image={require('@site/docs/General/get-id/img/utoc.webp').default} size="80%" align="left" />
    * Please ensure that when the power is off, measure the resistance between CAN H and CAN L with a multimeter to be around `60立`. If it is `120立`, you need to open the `120立` DIP switch. If it is around `40立`, you need to close the DIP switch
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-v3/flash/img/120.webp').default} size="100%" align="center" />

    <CANFLASH />

## Confirm Firmware Startup

    * If the firmware starts normally, the LED will light up
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-v3/flash/img/led.webp').default} size="100%" align="center" />

