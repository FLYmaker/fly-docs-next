import ImageView from '@site/src/components/ImageView';

import Button from "@mui/material/Button";


## Настройка CAN и поиск ID

* Если вам нужно использовать CAN, убедитесь, что ваш хост-компьютер настроен для работы с CAN

----

:::danger Внимание

Убедитесь, что материнская плата подключена к хост-компьютеру перед выполнением следующих действий

:::

:::warning

Убедитесь, что сеть CAN хост-компьютера, скорость CAN мостовой платы и скорость платы CAN инструмента полностью совпадают

:::

### Важные моменты перед поиском устройства

    * Перед поиском ID CAN убедитесь, что [подключены к SSH](/docs/DebugDoc/BasicTutorial/index.mdx "Нажмите, чтобы перейти")
    * Обратите внимание, что необходимо использовать сетевое подключение к SSH, а не последовательное соединение
    * Убедитесь, что UTOC подключен или на материнской плате прошит мостовой прошивки CAN, и что кабель, подключающий к хост-компьютеру, обладает функцией передачи данных

### Поиск устройства

    * Теперь, когда вы уже нормально вошли в хост-компьютер, вы можете ввести `lsusb` для поиска устройства. Будет одна из следующих ситуаций:
        * При вводе `lsusb` выдает сообщение о том, что не найдена команда `ls`, тогда вы можете ввести следующую команду для установки утилиты:
            ```bash
            sudo apt-get install usbutils
            ```
        * После ввода `lsusb` ничего не происходит, это проблема системы, здесь мы бессильны, вам нужно заменить систему или использовать проверенную систему
        * Появляется информация, как на изображении ниже, обратите внимание, это только пример. Вам нужно убедиться, что появляется `1d50:606f`
            <ImageView image={require('@site/docs/General/get-id/img/606f.png').default} size="100%" align="left" />
    * `1d50:606f` принадлежит устройству, которое вам нужно использовать. На последующие сообщения можно не обращать внимания, так как проблемы системы могут привести к тому, что они будут отображаться не полностью или вообще не отображаться
    * Если есть несколько `1d50:606f`, рекомендуется исключить одно, иначе это повлияет на последующую прошивку и подключение прошивки, например, для `FLY MINI PAD` рекомендуется использовать встроенный UTOC и не использовать другие устройства моста CAN
    * Если нет, проверьте самостоятельно, подключен ли кабель данных, прошита ли правильная прошивка

:::warning Обратите внимание
Только когда есть `1d50:606f`, можно переходить к поиску ID CAN
:::

### Поиск ID CAN

    * Введите следующую команду для поиска ID:
    ```bash
    ~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
    ```
    * Если появляется ID и в последней строке `Application:` отображается `Klipper`, это означает, что данный ID можно использовать напрямую
    * Если появляется ID и в последней строке `Application:` отображается `CANBOOT` или `Katapult`, это означает, что для использования необходимо прошить прошивку
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.png').default} size="50%" align="left" />


### Сборник проблем с CAN

    :::danger Внимание

    * Если не удается найти ID CAN, посмотрите следующий документ  
    * <Button variant="contained" disableElevation href="/docs/DebugDoc/faq/klipper_can">Сборник проблем с CAN</Button>

    :::

### Заполнение ID CAN в конфигурацию

    * Откройте веб-интерфейс принтера, в левом боковом меню найдите: для fluidd это: `{…}`; для mainsail это: `машина`, нажмите и войдите в `printer.cfg`

        <ImageView image={require('@site/docs/General/get-id/img/fluidd-cfg.png').default} size="50%" align="left" />

    * Скопируйте найденный UUID и вставьте в конфигурационный файл `printer.cfg` в узел `[mcu]` в поле `canbus_uuid: `. Сохраните и перезапустите, чтобы подключиться к материнской плате. Если Klipper сообщает, что прошивка нуждается в обновлении, ADC выдает ошибки и т.д., это означает, что Klipper уже подключен к материнской плате

        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.png').default} size="50%" align="left" />

        :::danger

        Обратите внимание: все ID, показанные в документации, являются примерами, фактические ID каждой материнской платы уникальны, пожалуйста, заполняйте их в соответствии с реально полученными ID.

        :::
